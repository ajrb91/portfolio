{"triggers":[],"nodes":[{"uid":"886535ae-f2b6-4452-b3fc-94f5392ed84f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Nombre del Proyecto: Lectura PDF"}}]},{"uid":"43b6a25f-c38a-4435-8370-ec675a0df48f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Versión: 2.0"}}]},{"uid":"4ecb570c-bdc6-4d8d-8f3d-4c239b07ff38","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0c0a4c54-f541-4057-b6bf-216a5d63b8e0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtener variable de Entorno \"Nombre de Usuario\""}}]},{"uid":"9749b783-5597-488e-aa8a-b6eb9c1715c9","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}},{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}}],"returnTo":{"type":"VARIABLE","variableName":"strNombreUsuarioMaquina"}},{"uid":"385205e6-12f7-4385-8051-b29d9af48280","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir la ruta de acceso a la carpeta de Entradas"}}]},{"uid":"4c8a7d74-785d-4504-b3d9-aa9a96c2585a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"C:\\Users\\$strNombreUsuarioMaquina$\\Desktop\\5 - Ejercicios Prácticos\\05_AutomatizacionPDFCorreo\\Entradas"}}],"returnTo":{"type":"VARIABLE","variableName":"strRutaEntradas"}},{"uid":"a9adb7e9-8ab3-4464-b99e-9a30ce070b3c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir la ruta de acceso a la carpeta de Temporales"}}]},{"uid":"ed44fb23-cd42-483c-9bd5-e3dfdfffe1a1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"C:\\Users\\$strNombreUsuarioMaquina$\\Desktop\\5 - Ejercicios Prácticos\\05_AutomatizacionPDFCorreo\\Temporales"}}],"returnTo":{"type":"VARIABLE","variableName":"strRutaTemporales"}},{"uid":"874cfeff-4130-4488-9bec-764d51f8a140","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir la ruta de acceso al archivo de Resultados (Datos Facturas)"}}]},{"uid":"1f9b6383-0131-4f83-90f8-7fd4240d793b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"C:\\Users\\$strNombreUsuarioMaquina$\\Desktop\\5 - Ejercicios Prácticos\\05_AutomatizacionPDFCorreo\\Salidas\\DatosFactura.csv"}}],"returnTo":{"type":"VARIABLE","variableName":"strRutaArchivoResultado"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Preparar Variables de Rutas"}}]},{"uid":"dba8123b-8acc-4a88-b4bb-22ec2b51a79c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fe6c79c1-b8ce-4028-8070-2a61f14f073b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Crear archivo txt donde se almacenarán los resultados"}}]},{"uid":"d8d17bfa-fceb-45ab-9c6d-137c399410fe","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strRutaArchivoResultado$"}},{"name":"logContent","value":{"type":"STRING","string":"Nro de Factura;Nombre Cliente;Monto Total"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Crear archivo de Datos de Factura"}}]},{"uid":"8beaedca-3d19-442a-b9c0-d4a3320c21cf","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"713217c1-e034-456a-afa5-4319e1786958","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Bucle para recorrer cada archivo presente en la carpeta objetivo"}}]},{"uid":"f439289b-c389-46c2-b569-22bdfe1029a0","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"93dee291-10b3-4f6d-9b39-f630079a87a3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer texto desde el PDF"}}]},{"uid":"8f1538ee-df0a-4337-beb5-ac84d5d124ed","commandName":"extractText","packageName":"PDF","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strRutaEntradas$/$dicArchivos{name}$.$dicArchivos{extension}$"}},{"name":"userSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"ownerSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"extractTextType","value":{"type":"STRING","string":"PLAIN"}},{"name":"pageOption","value":{"type":"STRING","string":"ALL"}},{"name":"outputFile","value":{"type":"FILE","expression":"file://$strRutaTemporales$/PDFOutputTemporal.txt"}},{"name":"overwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"174bcfd2-ffb8-4276-99b1-b02a207d3cb9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Abrir CSV e iterar por cada linea del texto"}}]},{"uid":"29ce0b25-a805-41c2-9262-8bdf24e1555a","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$strRutaTemporales$/PDFOutputTemporal.txt"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"newLine"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"936d9a79-f635-4b17-a329-45a3c7844160","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Reglas para extraer datos de forma estructurada"}}]},{"uid":"abd7b5c1-df2d-44e7-aeca-206ea1b0b328","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"7925a017-ffdc-4a00-8702-d0f3442108ca","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$regFilaArchivo[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"strTemporal"}},{"uid":"04f7f35c-51bd-4bd1-842d-a939d1d6ba7d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer Nro de Factura"}}]},{"uid":"eabbd915-bb2d-4f6d-b208-720bf17e8469","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"200da782-144f-44e6-a512-63f169472cd6","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"FACTURAR A N° DE FACTURA "}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":false}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strNroFactura"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"N° DE FACTURA"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"0fb5266a-9e54-40ed-8188-d0a7052b7e1e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer Nombre Cliente"}}]},{"uid":"d6c6bc71-483e-44d2-9287-598f8a4c18b7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7b777d54-ec79-43fd-bd93-5a25c2c967dd","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":"FECHA"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":false}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strNombreCliente"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"FECHA"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"ce7940de-3a43-407a-b3ed-99a98f747000","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer Total de Factura"}}]},{"uid":"a0c5953e-0eba-47f7-90b4-ee37ff2ecd90","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b47dacb8-26c2-4ca0-ac80-02f7be8bbd7a","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"TOTAL $"}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":false}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strTotalFactura"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strTemporal$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"TOTAL "}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"regFilaArchivo"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]},{"uid":"6c6da805-4cf1-4d86-a5a2-0b366d006d14","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Vaciar Datos en Archivo/Factura"}}]},{"uid":"f56b24e8-1b0a-4d31-8a9b-2db1d3c36ecd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strRutaArchivoResultado$"}},{"name":"logContent","value":{"type":"STRING","expression":"$strNroFactura$;$strNombreCliente$;$strTotalFactura$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8488f61c-e0ed-4af4-90c1-6171200656a5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Analizar Cantidad de Facturas Procesadas (Bien o mal)"}}]},{"uid":"71b378ce-21af-4683-ac28-caf9de334688","commandName":"OpenTransaction","packageName":"Analyze","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"3f90f86a-704c-4f86-89b0-98e8b43d0b12","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$numContadorFacturas$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"numContadorFacturas"}},{"uid":"cec7fcd2-5a50-4b2f-9147-2c7c6c46d8c1","commandName":"CloseTransaction","packageName":"Analyze","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"transactionType","value":{"type":"STRING","string":"Success"}},{"name":"sourceMap","value":{"type":"DICTIONARY","dictionary":[{"key":"numcontadorfacturas","value":{"type":"VARIABLE","variableName":"numcontadorfacturas"}}]}}]},{"uid":"5bba5c6d-0851-4b1b-920e-c07ad6a42b02","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Analizar Venta Total Procesada"}}]},{"uid":"7412306a-e24e-4f81-ac70-4213fa28cc59","commandName":"OpenTransaction","packageName":"Analyze","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"5a67b8a8-de92-49f4-9915-7bc9f439c4ab","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numVentaTotal$ + $strTotalFactura.String:toLocaleNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"numVentaTotal"}},{"uid":"b4a9bacb-5c0d-49da-a554-9065ab44aa77","commandName":"CloseTransaction","packageName":"Analyze","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"transactionType","value":{"type":"STRING","string":"Success"}},{"name":"sourceMap","value":{"type":"DICTIONARY","dictionary":[{"key":"numventatotal","value":{"type":"VARIABLE","variableName":"numventatotal"}}]}}]},{"uid":"0bbf8cc8-8e24-4127-adfc-5cb2b231c3b9","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dicArchivos"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strRutaEntradas$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Procesar lectura de archivos PDFs"}}]}],"variables":[{"name":"regFilaArchivo","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"strTemporal","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strNroFactura","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strNombreCliente","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strTotalFactura","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dicArchivos","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"strsPass","description":"","type":"CREDENTIAL","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Practia.2022"}},{"name":"strNombreUsuarioMaquina","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strRutaArchivoResultado","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strRutaEntradas","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strRutaTemporales","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numContadorFacturas","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"numVentaTotal","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":[],"packages":[{"name":"Analyze","version":"2.7.1-20230119-101334"},{"name":"Comment","version":"2.10.0-20220118-153626"},{"name":"CsvTxt","version":"2.8.0-20220118-153627"},{"name":"File","version":"6.2.0-20220118-133652"},{"name":"If","version":"3.4.0-20220127-062702"},{"name":"LogToFile","version":"3.4.0-20220118-133817"},{"name":"Loop","version":"3.4.0-20220127-062837"},{"name":"Number","version":"3.7.1-20230105-092807"},{"name":"PDF","version":"3.4.0-20220118-134144"},{"name":"Step","version":"2.5.0-20230105-135537"},{"name":"String","version":"5.3.0-20220118-134628"},{"name":"System","version":"3.11.2-20230106-081933"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}